<!doctype HTML>
<canvas id="canvas"></canvas>
<style>
/* ukanja sve margine i razmake*/
* {
	margin: 0; 
	padding: 0;
}

body {
	background-color: #00509F;
}

canvas {
	display: block;
}
</style>
<script>
window.onload = function(){
	var canvas = document.getElementById("canvas");
	var platno = canvas.getContext("2d");
	
	//canvas dimensions
	var shirina = window.innerWidth;
	var visina = window.innerHeight;
	canvas.width = shirina;
	canvas.height = visina;
	
	//snezne pahulje
	var max_pahulja = 25; //max pahulja
	var pahulje = [];
	for(var i = 0; i < max_pahulja; i++){
		pahulje.push({
			x: Math.random() * shirina, //x-polozaj
			y: Math.random() * visina, //y-polozaj
			r: Math.random() * 4 + 1, //poluprecnik
			d: Math.random() * max_pahulja //denzitet (gustina)
		})
	}
	
	function crtaPahulje(){
		platno.clearRect(0, 0, shirina, visina);
		
		platno.fillStyle = "rgba(255, 255, 255, 0.8)";
		platno.beginPath();
		for(var i = 0; i < max_pahulja; i++){
			var pahulja = pahulje[i];
			platno.moveTo(pahulja.x, pahulja.y);
			platno.arc(pahulja.x, pahulja.y, pahulja.r, 0, Math.PI*2, true);
		}
		platno.fill();
		pomeraPahulje();
	}
	
	//ugao neprestano raste. Sin and Cos functions will be applied to create vertical and horizontal movements of the flakes
	var ugao = 0;
	
	function pomeraPahulje(){
		ugao += 0.01;
		for(var i = 0; i < max_pahulja; i++){
			var pahulja = pahulje[i];
			//We will add 1 to the cos function to prevent negative values which will lead flakes to move upwards
			//Every particle has its own density which can be used to make the downward movement different
			//Lets make it more random by adding in the radius
			pahulja.y += Math.cos(ugao+pahulja.d) + 1 + pahulja.r/2;
			pahulja.x += Math.sin(ugao) * 2;
			
			//Sending flakes back from the top when it exits
			//Lets make it a bit more organic and let flakes enter from the left and right also.
			if(pahulja.x > shirina+5 || pahulja.x < -5 || pahulja.y > visina){
				//ako 66.67% pahulja
				if(i % 3 > 0) {
					pahulje[i] = {x: Math.random()*shirina, y: -10, r: pahulja.r, d: pahulja.d};
				}
				else{
					//If the flake is exitting from the right
					if(Math.sin(ugao) > 0){
						//Enter from the left
						pahulje[i] = {x: -5, y: Math.random()*visina, r: pahulja.r, d: pahulja.d};
					}else{
						//Enter from the right
						pahulje[i] = {x: shirina+5, y: Math.random()*visina, r: pahulja.r, d: pahulja.d};
					}
				}
			}
		}
	}
	//ponavljanje animacije
	setInterval(crtaPahulje, 33);
}
</script>